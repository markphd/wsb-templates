import React, { Component } from 'react';
import logo from './logo.svg';
import './App.css';
import data from './data/db.json'

const Datastore = require('nedb')
const db = new Datastore({})  

class App extends Component {
  componentWillMount() {
    var doc = data.templates;

    doc.map(template => db.insert(template, (err, templates) => err))

    db.find({"pages.id": { $in: this.state.templateOrder } }, (err, templates) => this.setState( (state) => state = {templates} ))
  }

  componentDidMount() {
    console.log("mounted")
  }

  constructor(props) {
    super(props);
    this.state = {
      templateOrder: ["A0392AC0-A1A4-440C-9D8B-B31EF1AEF6DE","667E3A08-C999-447A-9618-1F30C71B580C","C14552AC-8DB7-4150-AB51-9B73B9401FC4","D643A770-A0B3-4E81-8725-BA2AE1443018","38F05CB7-B2B6-43AF-8466-E8843CA34718","31D4768D-7F03-4A71-BD55-2B7107E9896E","4008EF7D-9386-4D35-B35D-9F81ACBCBBE6","DF9C2A4D-9FBB-4950-B52F-147D76088A31","1F194F96-B32C-4E0D-A48B-300A0364F822","285FEFE5-68BD-4A8E-B4E1-9392AFED3219","C8084765-471D-4662-BDBE-026B84AF2E22","7E4BF9AF-D1DF-40D5-934D-B80417355643","B23DF8FA-390A-42A0-94DA-BA9C4C5E3727","54D6A027-D2A9-43D5-843C-B9FA7DA27AAC","710A382D-0452-45FD-B0FA-CF85C58881F2","E875E841-C8BA-4F89-B7DD-190049904EF6","42957044-FC35-4995-9B4A-7E40F7C19153","AD4215B6-520D-4374-A528-53A5F651F49A","23583321-A2F2-4478-A996-7A99EA6541C2","D16D963A-BF9C-4463-9937-2E2CE154F6DD","C038B923-5140-493C-B73F-7AF542CB3D08","65C32B95-4550-4F3F-984B-5ABDE4AD5D9E","E910BCF9-BE84-42D7-8F13-C5FDC9E7859A","7058BCCD-D968-41AC-8347-BA25E75A346B","603F0CF9-6A58-45B5-B1B8-8888BD5FC97A","43832C0D-2A58-4B22-9C37-6DA817CD2EA5","66ED91F1-C65C-49B1-B8E6-66CE25207CD7","68A1CEC5-8443-49DA-A69E-10FD4EC1158A","9A769CDC-9EBF-40FD-A05B-B7C95CF2C2D2","1921575B-E4B7-40D9-A71D-F831DD78465E","CEF20D84-CBAB-4FCC-8C8A-D9954400AC05","42CD1A9F-F9A5-499C-96FA-4B2AF07596A3","084AA085-3E96-4BB7-AF97-52B6841485F2","C337552B-49CB-400F-8A27-0F7E739A9C96","3D50B879-D6BA-4E9C-8AD1-D1BE07EB8BDC","19C01FE6-985B-4FAA-A702-1EB4A9AEFBBA","CE38524B-4C39-40DD-835C-BCCC910C6C70","BCA2C9D5-7C5A-49D0-86D1-3A7E5961B2B5","C3566464-F522-4956-BAFE-DC1EC8346905","AFE0D697-B31D-4D3C-8BAE-F6E030894CF0","E6BECFFE-E8AE-4347-8231-4F952EF49393","EAE09073-6A96-4868-A79E-BB4180616034","917F5067-7446-4224-A3CA-A36F33793407","F8E77251-68FB-48FE-A095-57707A18912B","B12D4879-CD6B-430C-BB6C-992E925FD88B","1D37228D-FD7B-4EB5-A860-749D5BE194C3","A54D51AD-CC01-4463-B3B7-2DBD9A6FEF37","FEC7673E-9967-406E-99BC-62CE1D0A6936","2FA166B9-4BE6-4BA0-98B6-DE96BAD3F2BA","CE626112-0612-4A55-805E-0E91AB00BDBA","311EB8FA-A458-478B-AB21-FD2F7F4FD396","DD6F2D53-BECB-4B32-ACCD-B3CB7D584B6D","89267991-7599-4403-973C-5EAA3783B1E7","D3FB1D53-3D5B-4014-BFF6-C03B22371004","EE6B32F3-69A1-4CB1-8484-739959A262B3","ABDE7B7D-C2D2-4B0F-8A05-CD93FF231B43","25A9B706-70F2-4C76-9CAE-284251B469B6","B35C53DD-5C8C-470F-8DA8-2153976EECE9","68C76818-E65B-47A3-9596-6E17D6F12AD3","0D05EBAB-5B57-4AFC-B37F-D74C184DC330","A6D6D8E6-7CCD-48E3-98B8-225B15169B7C","90E6AE18-E966-411E-A206-A39CC4249640","22C2E58D-C04B-49C7-A5AA-CF94087F2772","1CF91525-45D5-45DD-8356-01676A31DE36","54800989-B457-4B9C-83F1-65F53E137C6E","176BC94D-2465-40B9-B85B-C252B145777D","F5764FBD-7435-458C-A387-5AA294513931","CB414496-EBCA-444A-9637-2F84BBF342E1","43B86FE4-41B7-474A-AFC1-508261E6504A","98B05EE6-3FF7-4225-8E6C-B364A4D5A4E7","060E9FC1-C3F1-47EF-A339-26B813F95FE2","A6B6C9A1-12E6-4B64-8100-460D635BF984","C14C7795-A390-4B21-860A-C02A36B0DB0D","EBDC86F6-7098-417F-BEB7-02AADF6AA0EF","E1FAD3A0-50DA-4B5F-99A7-B59BC46568BF","672EAAD3-66D9-41DB-AA81-1C0EFA461195","A4642118-4EC6-40C1-8426-C2FC9844AF65","F8B2BD28-2441-4B95-BC9C-9F439796C17F","1BBC770F-EDEA-478C-844B-49EE79B11AC3","2E30034F-1AF6-4230-997D-6F48AF1B0011","B6F2ED9D-A152-4959-A8F8-58F0C6E22FD1","D73C7D3F-DCD7-4370-86A4-490A44136013","5C5852E3-3BB3-46C1-9D1E-F7C7EDD008E5","6A89F07A-DA86-4645-8D7C-C569598B0570","C90CB248-F914-4E98-ADAF-F68C880B4057","0224F05C-E435-4733-A672-FE547D9FB33F","EF6525A1-4EDE-4DF0-832B-86501AD62D4F","125D220F-8FDC-4213-B966-E2F5FC03FDF5","58896882-CB5A-4CC1-992E-31E2B90BF944","F461723F-15FB-4AC9-A6DB-A67C3F29003A","07C057DE-6B9F-4054-AC3B-8A18D5576458","788775F0-0568-458E-AA05-1FF98F9D16AC","EBD0C7E9-CDC5-4192-AFB9-3CD3D1116E8A","334BBBC7-4FA8-446C-B74D-05735EAA1097","C3F11272-1DAB-4E12-893C-DE32C78E2AFE","5D06CBB0-1BB5-4C58-82E3-BC46594BB9EF","93C20709-9258-4424-8FED-00C0E4F182FE","0539D130-3B66-4115-B6B7-BEF0843229FC","EFE438DC-B311-40A0-8FEF-F171024B9534","5E510A6D-585F-4578-89B5-F62FCCB3F9B7","6945C55A-DB8F-4511-93EA-0AA6330D841C","98709062-2541-49E5-B719-2BD8EDCEAE34","DB127167-B1F2-414B-9314-1D0F59FB1EB5","001731EA-BAF4-426D-ABBB-89356CC12BF2","A33A597A-F6E4-45A6-9AED-FE31C04904FA","DDDF9E1C-E288-454B-B20D-2E5CA55E22B6","DFF82427-AC15-4AA4-96A8-C9D137E851CA","6462FADC-98D5-4B29-A7DA-2103F9DE5E9B","34AA3CB7-85D6-4EEB-BA1C-59BE944196FF","1A508E91-3007-4FD8-8BAA-24ACA61AAA68","D85CFDB4-466E-43BE-BDBD-F8D92BB37B60","5973DB30-E0E9-4B79-9B01-A6A4803A5B06","B4F12329-05EB-40E2-BE7E-BD36C0491D8D","607B35C9-EF6E-4608-B895-2C48E5604BED","1EAEF3EB-411E-4EAA-9FDE-5468F5B5754C","A1405D9D-9BE1-4AC5-8604-BE6E20F61A7E","5B0B340F-9400-4984-9F75-313A054FCD1E","9773A4DE-7F3D-480D-806C-47F2072A09F3","2685289B-22DA-4B34-A683-55E9AFC22105","A4F8FDA5-2AA3-437E-BF0A-904A71B79BD3","7434549F-3501-4637-B58C-028A7282733E","DAB59EC3-648B-4095-B233-1D935C33E2F6","4B88778E-0844-4F29-8C48-25ADD979BE07","724DC003-F351-4D99-B050-CA77A7F813AF","C179F788-A044-49E3-AF4D-2D27CBD60E5A","7DC3462C-86E8-43D1-AC14-95B9F3CAB7F5","23E5F695-A336-415F-8EDE-86F727E54ACE","34061178-2E48-4F01-AF05-799E56AC9835","03782AF4-B732-44D4-9B17-2B352438A8F7","3043CD74-B431-4AAE-8C0F-A4D93A82AE72","92D17A27-C501-4C1A-9B74-7F2126D476AA","3DB6416A-DF5F-47E5-8026-CDDA622DAC83","998163D4-6628-4431-9649-39330FF7B1DD","1C4669D4-606A-43B8-B5EA-6C3BFCC9171A","DA2CFBCD-2C75-4948-8B4E-1598383D5113","B672CFDA-B43F-4B45-992C-B38A6320EC3A"],
      templates: [{name: '', id: '', pages:[]}]
    }
  }

  render() {
    return (
      <div className="App">
        <header className="App-header">
          <img src={logo} className="App-logo" alt="logo" />
          <h1 className="App-title">Welcome to React</h1>
        </header>
        <p className="App-intro">
        </p>
        {this.state.templates.filter( item => {
          let templatePages = item.pages.values();
          for(const value of templatePages){
            console.log(this.state.templateOrder.indexOf(value.id), value.id, item.name)
          }
        })}
      </div>
    );
  }
}

export default App;